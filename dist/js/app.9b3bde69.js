(function(t){function e(e){for(var s,n,c=e[0],l=e[1],d=e[2],h=0,u=[];h<c.length;h++)n=c[h],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&u.push(i[n][0]),i[n]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);r&&r(e);while(u.length)u.shift()();return o.push.apply(o,d||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],s=!0,c=1;c<a.length;c++){var l=a[c];0!==i[l]&&(s=!1)}s&&(o.splice(e--,1),t=n(n.s=a[0]))}return t}var s={},i={app:0},o=[];function n(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=s,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(a,s,function(e){return t[e]}.bind(null,s));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var r=l;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"05ef":function(t,e,a){},"250d":function(t,e,a){},"2bac":function(t,e,a){"use strict";var s=a("db21"),i=a.n(s);i.a},"37a0":function(t,e,a){"use strict";var s=a("05ef"),i=a.n(s);i.a},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},o=[],n=a("8c4f"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"todo"},[a("FocusTrap",{attrs:{disabled:!t.trapActive}},[a("Dialog",{attrs:{shown:t.dialog.show,message:t.dialog.message},on:{decision:t.handleDecision}})],1),a("h2",{staticClass:"todo__header"},[t._v("Список дел")]),a("div",{staticClass:"todo__list"},[t._l(t.todos,(function(e,s){return a("div",{staticClass:"todo__task"},[a("div",{staticClass:"todo__inner"},[a("h3",{staticClass:"todo__task-name"},[t._v(t._s(e.title))]),a("ul",{staticClass:"todo__task-list"},t._l(t.filterItems(s),(function(e){return a("li",{staticClass:"todo__task-item",class:{done:e.checked}},[t._v(t._s(e.task))])})),0),t.todos[s].tasks.length-2>0?a("span",{staticClass:"todo__task-additional"},[t._v("- еще "+t._s(t.todos[s].tasks.length-2)+" в списке -")]):t._e(),a("div",{staticClass:"todo__task-controls"},[a("router-link",{attrs:{to:{name:"Change",params:{title:e.title,tasks:e.tasks,index:s}}}},[a("div",{staticClass:"todo__task-action todo__task-action--change"})]),a("div",{staticClass:"todo__task-action todo__task-action--delete",on:{click:function(a){return t.showDialog("Вы уверены что хотите удалить задачу "+e.title+"?","delete",s)}}})],1)])])})),a("div",{staticClass:"todo__task"},[a("div",{staticClass:"todo__inner"},[a("div",{staticClass:"todo__create",on:{click:t.addToList}},[a("span",{staticClass:"todo__create-text"},[t._v("Добавить")])])])])],2)],1)},l=[],d=(a("fb6a"),a("5530")),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"container",staticClass:"dialog",class:{shown:t.shown},on:{click:function(e){return t.closeDialog(e)}}},[a("div",{staticClass:"dialog__inner"},[a("span",{staticClass:"dialog__text"},[t._v(t._s(t.message))]),a("div",{ref:"answers",staticClass:"dialog__actions"},[a("button",{ref:"answer",staticClass:"dialog__btn",on:{click:function(e){return t.confirmDecision(!0)}}},[t._v("Да")]),a("button",{staticClass:"dialog__btn",on:{click:function(e){return t.confirmDecision(!1)}}},[t._v("Нет")])])])])},h=[],u={props:{shown:Boolean,message:String},methods:{closeDialog:function(t){t.target!==this.$refs.container||t.target.closest("div").classList.contains("dialog__inner")||this.$emit("decision",!1)},confirmDecision:function(t){this.$emit("decision",t)},focusOnDialog:function(){this.$refs.answer.focus()}},watch:{shown:function(){this.focusOnDialog()}}},g=u,k=(a("75e8"),a("2877")),_=Object(k["a"])(g,r,h,!1,null,null,null),f=_.exports,v=a("5df7"),p=a.n(v),m=a("2f62"),C={name:"App",components:{Dialog:f,FocusTrap:p.a},data:function(){return{trapActive:!1,dialog:{index:null,show:!1,message:"",answer:null,delete:!1,discard:!1},todos:[]}},methods:Object(d["a"])(Object(d["a"])(Object(d["a"])({},Object(m["c"])(["getTodos"])),Object(m["b"])(["deleteFromList","addToList","loadState","saveState"])),{},{handleDecision:function(t){t&&this.dialog.delete?this.deleteTodo():this.hideDialog()},deleteTodo:function(){this.deleteFromList(this.dialog.index),this.hideDialog(),this.saveState()},showDialog:function(t,e,a){this.trapActive=!0,this.dialog.index=a,this.dialog.show=!0,this.dialog.message=t,"delete"===e?this.dialog.delete=!0:this.dialog.discard=!0},hideDialog:function(){this.trapActive=!1,this.dialog.show=!1,this.dialog.message="",this.dialog.answer=null,this.dialog.delete=!1,this.dialog.discard=!1},filterItems:function(t){return this.todos[t].tasks.slice(0,2)}}),mounted:function(){this.loadState(),this.todos=this.getTodos()}},w=C,b=(a("37a0"),Object(k["a"])(w,c,l,!1,null,null,null)),D=b.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"change",class:{redacted:!t.inputBlocked}},[a("FocusTrap",{attrs:{disabled:!t.trapActive}},[a("Dialog",{ref:"dialog",attrs:{shown:t.dialog.show,message:t.dialog.message},on:{decision:t.handleDecision}})],1),void 0===t.title&&void 0===t.tasks||t.deleted?[a("div",{staticClass:"change__placeholder"},[a("span",{staticClass:"change__text"},[t._v(" Выберите задачу на"),a("br"),a("router-link",{attrs:{to:"/"}},[t._v("главной странице")])],1)])]:[a("div",{staticClass:"change__inner"},[a("div",{staticClass:"change__actions change__actions--top"},[a("router-link",{attrs:{to:{name:"List"}}},[a("span",{staticClass:"change__action change__action--back"})]),a("button",{staticClass:"change__action change__action--delete",on:{click:function(e){return t.showDialog("Вы уверены что хотите удалить задачу "+t.title+"?","delete")}}},[t._v("Удалить из списка")]),a("button",{staticClass:"change__action",class:{"change__action--stop":!t.inputBlocked,"change__action--redact":t.inputBlocked},on:{click:t.letChanges}})],1),a("div",{staticClass:"change__title-wrap",class:{redactable:!t.inputBlocked}},[a("h2",{staticClass:"change__title"},[t._v("Заголовок:")])]),a("label",{staticClass:"change__label change__label--title",attrs:{for:t.title}},[t.inputBlocked?a("span",{staticClass:"change__caption"},[t._v(t._s(t.localChanges.title.old))]):t._e(),t.inputBlocked?t._e():a("input",{directives:[{name:"model",rawName:"v-model",value:t.localChanges.title.old,expression:"localChanges.title.old"}],staticClass:"change__input",attrs:{type:"text",autocomplete:"off",id:t.title},domProps:{value:t.localChanges.title.old},on:{input:function(e){e.target.composing||t.$set(t.localChanges.title,"old",e.target.value)}}}),a("span",{staticClass:"change__return",class:{back:t.showRevertBack,forward:t.showRevertForward&&!t.showRevertBack},on:{click:function(e){t.showRevertBack?t.revertTitle("old"):t.revertTitle("new")}}})]),a("div",{staticClass:"change__title-wrap",class:{redactable:!t.inputBlocked}},[a("h2",{staticClass:"change__title"},[t._v("Подзадачи:")])]),t._l(t.localChanges.tasks,(function(e,s){return a("label",{staticClass:"change__label",class:{redactable:!t.inputBlocked}},[t.inputBlocked?t._e():a("span",{staticClass:"change__task-delete",on:{click:function(e){return t.removeTask(s)}}}),t.inputBlocked?a("span",{staticClass:"change__caption"},[t._v(t._s(e.old))]):t._e(),t.inputBlocked?t._e():a("input",{directives:[{name:"model",rawName:"v-model",value:e.old,expression:"item.old"}],staticClass:"change__input",class:{padded:t.checkRevertBack(s)||t.checkRevertForward(s)},attrs:{type:"text",autocomplete:"off"},domProps:{value:e.old},on:{input:function(a){a.target.composing||t.$set(e,"old",a.target.value)}}}),a("span",{staticClass:"change__return change__return--task",class:{back:t.checkRevertBack(s),forward:t.checkRevertForward(s)&&!t.checkRevertBack(s)},on:{click:function(e){t.checkRevertBack(s)?t.revertTask("old",s):t.revertTask("new",s)}}}),a("label",{attrs:{for:s}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.checked,expression:"item.checked"}],staticClass:"change__check",attrs:{type:"checkbox",id:s},domProps:{checked:e.checked,checked:Array.isArray(e.checked)?t._i(e.checked,null)>-1:e.checked},on:{change:function(a){var s=e.checked,i=a.target,o=!!i.checked;if(Array.isArray(s)){var n=null,c=t._i(s,n);i.checked?c<0&&t.$set(e,"checked",s.concat([n])):c>-1&&t.$set(e,"checked",s.slice(0,c).concat(s.slice(c+1)))}else t.$set(e,"checked",o)}}})])])})),t.inputBlocked?t._e():a("button",{staticClass:"change__action change__action--add",on:{click:t.addTask}},[t._v("Добавить")]),a("div",{staticClass:"change__actions change__actions--bottom"},[a("button",{staticClass:"change__action change__action--discard",on:{click:function(e){return t.showDialog("Вы уверены что хотите отменить все изменения?","discard")}}},[t._v("Отменить изменения")]),a("button",{staticClass:"change__action change__action--save",attrs:{disabled:!t.savable},on:{click:t.saveAll}},[t._v("Сохранить")])])],2)]],2)},x=[],B=(a("45fc"),a("a434"),a("a9e3"),a("b85c")),y={props:{index:Number,title:String,tasks:Array},components:{Dialog:f,FocusTrap:p.a},data:function(){return{inputBlocked:!0,deleted:!1,trapActive:!1,taskListChanged:!1,localData:{title:{old:"",new:""},tasks:[]},localChanges:{title:{old:"",new:""},tasks:[]},dialog:{index:null,show:!1,message:"",answer:null,delete:!1,discard:!1}}},methods:Object(d["a"])(Object(d["a"])({},Object(m["b"])(["deleteFromList","addToList","changeListItem","saveState"])),{},{letChanges:function(){this.inputBlocked=!this.inputBlocked},revertTitle:function(t){"old"===t?(this.localChanges.title.new=this.localChanges.title.old,this.localChanges.title.old=this.localData.title.old):(this.localChanges.title.old=this.localChanges.title.new,this.localChanges.title.new="")},revertTask:function(t,e){"old"===t?(this.localChanges.tasks[e].new=this.localChanges.tasks[e].old,void 0!==this.localData.tasks[e]?this.localChanges.tasks[e].old=this.localData.tasks[e].old:this.localChanges.tasks[e].old="Новая подзадача"):(this.localChanges.tasks[e].old=this.localChanges.tasks[e].new,this.localChanges.tasks[e].new="")},checkRevertBack:function(t){return void 0!==this.localData.tasks[t]?this.localChanges.tasks[t].old!==this.localData.tasks[t].old&&!this.inputBlocked:"Новая подзадача"!==this.localChanges.tasks[t].old&&!this.inputBlocked},checkRevertForward:function(t){return this.checkRevertBack(t),""!==this.localChanges.tasks[t].new&&!this.inputBlocked},saveAll:function(){var t,e={index:this.index,title:this.localChanges.title.old,tasks:[]},a=Object(B["a"])(this.localChanges.tasks);try{for(a.s();!(t=a.n()).done;){var s=t.value;e.tasks.push({task:s.old,checked:s.checked})}}catch(i){a.e(i)}finally{a.f()}this.changeListItem(e),this.setLocalChanges(),this.inputBlocked=!0,this.saveState()},discardAll:function(){this.inputBlocked=!0,this.taskListChanged=!1,this.setLocalData(),this.hideDialog()},handleDecision:function(t){t&&this.dialog.delete?this.deleteTodo():t&&this.dialog.discard?this.discardAll():this.hideDialog()},deleteTodo:function(){this.deleted=!0,this.deleteFromList(this.dialog.index),this.hideDialog(),this.saveState()},showDialog:function(t,e){this.dialog.show=!0,this.trapActive=!0,this.dialog.message=t,"delete"===e?this.dialog.delete=!0:this.dialog.discard=!0},hideDialog:function(){this.trapActive=!1,this.dialog.show=!1,this.dialog.message="",this.dialog.answer=null,this.dialog.delete=!1,this.dialog.discard=!1},addTask:function(){var t=this.localData.tasks;this.localChanges.tasks.push({old:"Новая подзадача",new:"",checked:!1,created:!0}),this.checkTasksChanges(t),this.localData.tasks.push({old:"Новая подзадача",new:"",checked:!1,created:!0})},removeTask:function(t){var e=this.localData.tasks;this.localChanges.tasks.splice(t,1),this.checkTasksChanges(e),this.localData.tasks.splice(t,1)},checkTasksChanges:function(t){for(var e=this,a=[],s=this.localChanges.tasks.length===t.length,i=function(s){void 0!==t[s]?a.push(e.localChanges.tasks.some((function(e){return e.old===t[s].old&&e.checked===t[s].checked}))):a.push(!1)},o=0;o<this.localChanges.tasks.length;o++)i(o);this.taskListChanged=s?a.some((function(t){return!1===t})):!s},setLocalData:function(){if(this.localChanges.title.old=this.title,this.localData.title.old=this.title,void 0!==this.tasks){this.localChanges.tasks=[],this.localData.tasks=[];var t,e=Object(B["a"])(this.tasks);try{for(e.s();!(t=e.n()).done;){var a=t.value;this.localChanges.tasks.push({old:a.task,new:"",checked:a.checked}),this.localData.tasks.push({old:a.task,new:"",checked:a.checked})}}catch(s){e.e(s)}finally{e.f()}}},setLocalChanges:function(){this.localData.title.old=this.localChanges.title.old,this.taskListChanged=!1,this.localData.tasks=[];var t,e=Object(B["a"])(this.localChanges.tasks);try{for(e.s();!(t=e.n()).done;){var a=t.value;this.localData.tasks.push({old:a.old,new:"",checked:a.checked})}}catch(s){e.e(s)}finally{e.f()}},checkChange:function(t){var e,a=this;switch(t){case"title":e=this.localChanges.title.old!==this.localData.title.old;break;case"taskText":e=this.localData.tasks.some((function(t,e){return t.old!==a.localChanges.tasks[e].old}));break;case"taskState":e=this.localData.tasks.some((function(t,e){return t.checked!==a.localChanges.tasks[e].checked}));break;default:e=!1;break}return e}}),computed:{showRevertBack:function(){return this.localChanges.title.old!==this.localData.title.old&&!this.inputBlocked},showRevertForward:function(){return""!==this.localChanges.title.new&&!this.inputBlocked},savable:function(){var t=this.checkChange("title"),e=this.checkChange("taskText"),a=this.checkChange("taskState");return this.taskListChanged||t||e||a}},mounted:function(){this.dialog.index=this.index,this.setLocalData()}},O=y,L=(a("2bac"),Object(k["a"])(O,T,x,!1,null,null,null)),S=L.exports,j=new n["a"]({routes:[{path:"/",name:"List",component:D,props:!0},{path:"/change",name:"Change",component:S,props:!0}],scrollBehavior:function(){return{x:0,y:0}}}),A={actions:{deleteFromList:function(t,e){t.commit("deleteTodo",e),t.commit("saveTodos")},addToList:function(t){t.commit("addTodo"),t.commit("saveTodos")},changeListItem:function(t,e){var a=e.index,s=e.title,i=e.tasks;t.commit("rewriteListItem",{index:a,title:s,tasks:i})},saveState:function(t){t.commit("saveTodos")},loadState:function(t){t.commit("loadTodos")}},mutations:{deleteTodo:function(t,e){t.todos.splice(e,1)},addTodo:function(t){t.todos.push({title:"Новая задача",tasks:[]})},rewriteListItem:function(t,e){var a=e.index,s=e.title,i=e.tasks;t.todos[a]={title:s,tasks:i}},saveTodos:function(t){localStorage.setItem("savedStateData",JSON.stringify(t.todos))},loadTodos:function(t){null!==localStorage.getItem("savedStateData")&&(t.todos=JSON.parse(localStorage.getItem("savedStateData")))}},getters:{getTodos:function(t){return t.todos}},state:{todos:[{title:"Задача 1",tasks:[{task:"Подзадача 1",checked:!1},{task:"Подзадача 2",checked:!1},{task:"Подзадача 3",checked:!0},{task:"Подзадача 4",checked:!1}]}]}};s["a"].use(m["a"]);var R=new m["a"].Store({modules:{todos:A}}),F={name:"App",router:j,store:R},$=F,I=(a("975b"),Object(k["a"])($,i,o,!1,null,null,null)),P=I.exports;s["a"].use(n["a"]),s["a"].config.productionTip=!1,new s["a"]({render:function(t){return t(P)}}).$mount("#app")},"75e8":function(t,e,a){"use strict";var s=a("250d"),i=a.n(s);i.a},"8a91":function(t,e,a){},"975b":function(t,e,a){"use strict";var s=a("8a91"),i=a.n(s);i.a},db21:function(t,e,a){}});
//# sourceMappingURL=app.9b3bde69.js.map